name: WhatsApp Otomatik Kontrol

# Her 3 dakikada bir Ã§alÄ±ÅŸ
on:
  schedule:
    - cron: '*/3 * * * *'
  # Manuel Ã§alÄ±ÅŸtÄ±rma imkanÄ±
  workflow_dispatch:

jobs:
  whatsapp-control:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ¤– WhatsApp Kontrol Ã‡alÄ±ÅŸtÄ±r
      run: |
        echo "â° $(date): WhatsApp kontrol baÅŸlatÄ±lÄ±yor..."
        
        # Ana kontrol URL'si
        response=$(curl -s -w "%{http_code}" "http://phonegrafi.com/wap/cron/auto-control.php?cron=1")
        
        if [[ "$response" == *"200" ]]; then
          echo "âœ… Kontrol baÅŸarÄ±lÄ± - HTTP 200"
        else
          echo "âŒ Kontrol hatasÄ± - HTTP: $response"
          exit 1
        fi
        
        echo "âœ… $(date): WhatsApp kontrol tamamlandÄ±"
    
    - name: ğŸ“Š Sistem Durumu Kontrol
      run: |
        echo "ğŸ“Š Sistem durumu kontrol ediliyor..."
        
        # Sistem status kontrolÃ¼ (opsiyonel)
        status=$(curl -s "http://phonegrafi.com/wap/api/get-auto-status.php" | head -c 100)
        echo "Sistem durumu: $status"
